<div class="poster-rows" aria-hidden="true">
  <div class="row r1"><div class="inner"></div></div>
  <div class="row r2"><div class="inner"></div></div>
  <div class="row r3"><div class="inner"></div></div>
  <div class="row r4"><div class="inner"></div></div>
  <div class="row r5"><div class="inner"></div></div>
  <div class="row r6"><div class="inner"></div></div>
  <div class="row r7"><div class="inner"></div></div>
  <div class="row r8"><div class="inner"></div></div>
  <div class="row r9"><div class="inner"></div></div>
  <div class="row r10"><div class="inner"></div></div>
</div>

<div class="container" *ngIf="!loading && !error; else loadingOrError">
  <div class="left-information">
    <p class="row" *ngIf="showDirWriterCombined; else separateDirWriter">
      <span class="label">Director/Writer:</span>
      <span class="value">{{ directorName || 'N/A' }}</span>
    </p>

    <ng-template #separateDirWriter>
      <p class="row" *ngIf="directorName">
        <span class="label">Director:</span>
        <span class="value">{{ directorName }}</span>
      </p>

      <p class="row" *ngIf="writerNames.length > 0">
        <span class="label">{{ writerNames.length > 1 ? 'Writers:' : 'Writer:' }}</span>
        <span class="value">{{ formatWritersText(writerNames) }}</span>
      </p>
    </ng-template>

    <p class="row">
      <span class="label">Release Date:</span>
      <span class="value">{{ fixRelease(combinedApiResult.released) }}</span>
    </p>

    <p class="row" *ngIf="(combinedApiResult.type || '').toLowerCase() === 'movie' && isPresent(combinedApiResult.boxOffice)">
      <span class="label">Box Office:</span>
      <span class="value">{{ combinedApiResult.boxOffice }}</span>
    </p>

    <p class="row" *ngIf="formattedGenres as g">
      <span class="label">{{ g.label }}:</span>
      <span class="value">{{ g.text }}</span>
    </p>

    <p class="row" *ngIf="isPresent(combinedApiResult.awards)">
      <span class="label">Awards:</span>
      <span class="value">{{ combinedApiResult.awards }}</span>
    </p>

    <p class="row">
      <span class="label">Summary:</span>
      <span class="value">{{ combinedApiResult.plot || 'N/A' }}</span>
    </p>

    <div class="trailer" *ngIf="combinedApiResult.trailer">
      <a (click)="goToTrailer(combinedApiResult.trailer)">Watch The Trailer</a>
    </div>
  </div>

  <div class="right-information" *ngIf="combinedApiResult as f">
    <div class="film-information">
      <div class="film-left">
        <div class="film-scroll">
          <p class="title">{{ f.title }}</p>
          <p class="release" *ngIf="f.released && isMovie">{{ fixRelease(f.released) }}</p>
          <p class="release" *ngIf="f.year && isSeries">{{ displayYear(f.year) }}</p>

          <div class="meta">
            <span class="badge" *ngIf="f.rated">{{ f.rated }}</span>

            <span class="badge" *ngIf="(f.genre || '').length">
              {{ (f.genre || '').split(', ').join(' • ') }}
            </span>
          </div>
        </div>

        <div class="film-counts">
          <div class="count" *ngIf="runtimeHours !== 0 || totalSeasons !== 0">
            <div class="count-num">{{ count1Num }}</div>
            <div class="count-label">{{ count1Label }}</div>
          </div>

          <div class="count" *ngIf="runtimeMinutesRemainder !== 0 || totalEpisodes !== 0">
            <div class="count-num">{{ count2Num }}</div>
            <div class="count-label">{{ count2Label }}</div>
          </div>
        </div>
      </div>

      <img
        class="film-poster"
        [src]="posterSrc"
        [attr.alt]="f.title || 'Poster'"
        (error)="setFallback($event)"
        loading="lazy"
        decoding="async"
        />
    </div>

    <div class="streaming-on">
      <p class="label">Streaming On:</p>

      <div class="streaming-services" *ngIf="streamingServices.length !== 0; else noStreamingServices">
        <a
          *ngFor="let provider of streamingServices; trackBy: trackByProviderName"
          class="provider-logo-link"
          [attr.href]="provider.url || null"
          [class.is-disabled]="!provider.url"
          target="_blank"
          rel="noopener noreferrer"
          [attr.aria-label]="provider.url ? ('Open on ' + provider.name) : null"
        >
          <img
            class="provider-logo"
            [src]="provider.logo"
            [attr.alt]="provider.name"
            (error)="onLogoError(provider)"
            loading="lazy"
            decoding="async"
          />
        </a>
      </div>

      <ng-template #noStreamingServices>
        <p class="no-streaming-services">N/A</p>
      </ng-template>
    </div>

    <div class="ratings-button">
      <div class="ratings">
        <div class="ratings-item imdb-rating">
          <a class="logo-link"
            [attr.href]="imdbUrl || null"
            [class.is-disabled]="!imdbUrl"
            target="_blank" rel="noopener noreferrer"
            aria-label="Open on IMDb"
          >
            
            <img 
              class="imdb-img"
              src="https://upload.wikimedia.org/wikipedia/commons/6/69/IMDB_Logo_2016.svg"
              alt="IMDb" 
            />
          </a>

          <p class="score">{{ getRatingValue(0) }}</p>
        </div>

        <div class="ratings-item rotten-tomatoes-rating">
          <a class="logo-link"
            [attr.href]="rottenTomatoesUrl || null"
            [class.is-disabled]="!rottenTomatoesUrl"
            target="_blank" rel="noopener noreferrer"
            aria-label="Open on Rotten Tomatoes"
          >
            <img 
              class="rotten-tomatoes-img"
              src="https://upload.wikimedia.org/wikipedia/commons/6/6f/Rotten_Tomatoes_logo.svg"
              alt="Rotten Tomatoes"
            />
          </a>

          <p class="score">{{ getRatingValue(1) }}</p>
        </div>

        <div class="ratings-item metacritic-rating">
          <a class="logo-link"
            [attr.href]="metacriticUrl || null"
            [class.is-disabled]="!metacriticUrl"
            target="_blank" rel="noopener noreferrer"
            aria-label="Open on Metacritic"
          >
            <img 
              class="metacritic-img"
              src="https://upload.wikimedia.org/wikipedia/commons/c/ce/Metacritic_logo_original.svg"
              alt="Metacritic" 
            />
          </a>

          <p class="score">{{ getRatingValue(2) }}</p>
        </div>
      </div>

      <button 
        type="button" 
        class="rate-button" 
        *ngIf="f.released && showButton(f.released)" 
        (click)="onRateThisFilm()"
        [class.disabled]="!canRateFilm()"
        [disabled]="!canRateFilm()"
        [attr.title]="runtimeRateButtonTitle()"
      >
        <span *ngIf="isCheckingRating()">Checking...</span>
        <span *ngIf="!isCheckingRating() && !hasAlreadyRated()">Rate "{{ f.title }}"</span>
        <span *ngIf="!isCheckingRating() && hasAlreadyRated()">Already Rated</span>
      </button>
    </div>
  </div>
</div>

<ng-template #loadingOrError>
  <!-- Error message -->
  <div class="loading-error" *ngIf="!loading && error">
    <p>{{ error }}</p>
  </div>

  <!-- ✅ NEW: Comprehensive shimmer loading -->
  <div class="container shimmer-container" *ngIf="loading">
    <!-- Left Column Shimmer -->
    <div class="left-information shimmer-left">
      <div class="shimmer-row">
        <div class="shimmer-label"></div>
        <div class="shimmer-value" style="width: 60%;"></div>
      </div>
      <div class="shimmer-row">
        <div class="shimmer-label"></div>
        <div class="shimmer-value" style="width: 45%;"></div>
      </div>
      <div class="shimmer-row">
        <div class="shimmer-label"></div>
        <div class="shimmer-value" style="width: 70%;"></div>
      </div>
      <div class="shimmer-row">
        <div class="shimmer-label"></div>
        <div class="shimmer-value" style="width: 55%;"></div>
      </div>
      <div class="shimmer-row">
        <div class="shimmer-label"></div>
        <div class="shimmer-value" style="width: 65%;"></div>
      </div>
      <div class="shimmer-row">
        <div class="shimmer-label"></div>
        <div class="shimmer-value" style="width: 85%;"></div>
      </div>
    </div>

    <!-- Right Column Shimmer -->
    <div class="right-information shimmer-right">
      <!-- Film Info Shimmer -->
      <div class="film-information shimmer-film-info">
        <div class="shimmer-film-content">
          <div class="shimmer-title"></div>
          <div class="shimmer-release"></div>
          <div class="shimmer-badges">
            <div class="shimmer-badge"></div>
            <div class="shimmer-badge"></div>
          </div>
          <div class="shimmer-spacer"></div>
          <div class="shimmer-counts">
            <div class="shimmer-count">
              <div class="shimmer-count-num"></div>
              <div class="shimmer-count-label"></div>
            </div>
            <div class="shimmer-count">
              <div class="shimmer-count-num"></div>
              <div class="shimmer-count-label"></div>
            </div>
          </div>
        </div>
        <div class="shimmer-poster"></div>
      </div>

      <!-- Streaming Shimmer -->
      <div class="streaming-on shimmer-streaming">
        <p class="label">Streaming On:</p>
        <div class="shimmer-providers">
          <div class="shimmer-provider"></div>
          <div class="shimmer-provider"></div>
          <div class="shimmer-provider"></div>
          <div class="shimmer-provider"></div>
        </div>
      </div>

      <!-- Ratings + Button Shimmer -->
      <div class="ratings-button shimmer-ratings-button">
        <div class="ratings shimmer-ratings-grid">
          <div class="shimmer-rating-item">
            <div class="shimmer-rating-logo"></div>
            <div class="shimmer-rating-score"></div>
          </div>
          <div class="shimmer-rating-item">
            <div class="shimmer-rating-logo"></div>
            <div class="shimmer-rating-score"></div>
          </div>
          <div class="shimmer-rating-item">
            <div class="shimmer-rating-logo"></div>
            <div class="shimmer-rating-score"></div>
          </div>
        </div>
        
        <!-- ✅ Rate button shimmer -->
        <div class="rate-button shimmer-rate-button"></div>
      </div>
    </div>
  </div>
</ng-template>